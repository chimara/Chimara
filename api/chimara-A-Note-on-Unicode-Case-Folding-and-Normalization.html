<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>A Note on Unicode Case-Folding and Normalization</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.71.0">
<link rel="start" href="index.html" title="Chimara Reference Manual">
<link rel="up" href="chimara-glk-spec-character-encoding.html" title="Character Encoding">
<link rel="prev" href="chimara-Unicode-String-Normalization.html" title="Unicode String Normalization">
<link rel="next" href="chimara-glk-spec-windows.html" title="Windows">
<meta name="generator" content="GTK-Doc V1.25 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="5"><tr valign="middle">
<td width="100%" align="left" class="shortcuts"></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="16" height="16" border="0" alt="Home"></a></td>
<td><a accesskey="u" href="chimara-glk-spec-character-encoding.html"><img src="up.png" width="16" height="16" border="0" alt="Up"></a></td>
<td><a accesskey="p" href="chimara-Unicode-String-Normalization.html"><img src="left.png" width="16" height="16" border="0" alt="Prev"></a></td>
<td><a accesskey="n" href="chimara-glk-spec-windows.html"><img src="right.png" width="16" height="16" border="0" alt="Next"></a></td>
</tr></table>
<div class="refentry" lang="en">
<a name="chimara-A-Note-on-Unicode-Case-Folding-and-Normalization"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle">A Note on Unicode Case-Folding and Normalization</span></h2>
<p>A Note on Unicode Case-Folding and Normalization — How to handle line input</p>
</td>
<td class="gallery_image" valign="top" align="right"></td>
</tr></table></div>
<div class="refsect1" lang="en">
<a name="idp140340078350256"></a><h2>Description</h2>
<p>
With all of these Unicode transformations hovering about, an author might reasonably ask about the right way to handle line input.
Our recommendation is: call <a href="chimara-Upper-and-Lower-Case.html#glk-buffer-to-lower-case-uni" title="glk_buffer_to_lower_case_uni ()"><code class="function">glk_buffer_to_lower_case_uni()</code></a>, followed by <a href="chimara-Unicode-String-Normalization.html#glk-buffer-canon-normalize-uni" title="glk_buffer_canon_normalize_uni ()"><code class="function">glk_buffer_canon_normalize_uni()</code></a>, and then parse the result.
The parsing process should of course match against strings that have been put through the same process.
</p>
<p>
The Unicode spec (chapter 3.13) gives a different, three-step process: decomposition, case-folding, and decomposition again.
Our recommendation comes through a series of practical compromises:
</p>
<div class="itemizedlist"><ul type="disc">
<li><p>
    The initial decomposition is only necessary because of a historical error in the Unicode spec: character 0x0345 (COMBINING GREEK YPOGEGRAMMENI) behaves inconsistently.
	We ignore this case, and skip this step.
  </p></li>
<li><p>
    Case-folding is a slightly different operation from lower-casing.
	(Case-folding splits some combined characters, so that, for example, “ß” can match both “ss” and “SS”.)
	However, Glk does not currently offer a case-folding function.
	We substitute <a href="chimara-Upper-and-Lower-Case.html#glk-buffer-to-lower-case-uni" title="glk_buffer_to_lower_case_uni ()"><code class="function">glk_buffer_to_lower_case_uni()</code></a>.
  </p></li>
<li><p>
    I'm not sure why the spec recommends decomposition (<a href="chimara-Unicode-String-Normalization.html#glk-buffer-canon-decompose-uni" title="glk_buffer_canon_decompose_uni ()"><code class="function">glk_buffer_canon_decompose_uni()</code></a>) rather than <a href="chimara-Unicode-String-Normalization.html#glk-buffer-canon-normalize-uni" title="glk_buffer_canon_normalize_uni ()"><code class="function">glk_buffer_canon_normalize_uni()</code></a>.
	However, composed characters are the norm in source code, and therefore in compiled Inform game files.
	If we specified decomposition, the compiler would have to do extra work; also, the standard Inform dictionary table (with its fixed word length) would store fewer useful characters.
	Therefore, we substitute <a href="chimara-Unicode-String-Normalization.html#glk-buffer-canon-normalize-uni" title="glk_buffer_canon_normalize_uni ()"><code class="function">glk_buffer_canon_normalize_uni()</code></a>.
  </p></li>
</ul></div>
<div class="note">
<h3 class="title"></h3>
<p>
  We may revisit these recommendations in future versions of the spec.
</p>
</div>
</div>
</div>
<div class="footer">
<hr>Generated by GTK-Doc V1.25</div>
</body>
</html>