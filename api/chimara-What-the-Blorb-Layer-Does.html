<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>What the Blorb Layer Does</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.71.0">
<link rel="start" href="index.html" title="Chimara Reference Manual">
<link rel="up" href="chimara-glk-spec-the-blorb-layer.html" title="Appendix B. The Blorb Layer">
<link rel="prev" href="chimara-What-the-Library-Does.html" title="What the Library Does">
<link rel="next" href="chimara-Blorb-Errors.html" title="Blorb Errors">
<meta name="generator" content="GTK-Doc V1.25 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="5"><tr valign="middle">
<td width="100%" align="left" class="shortcuts">
<a href="#" class="shortcut">Top</a><span id="nav_description">  <span class="dim">|</span> 
                  <a href="#chimara-What-the-Blorb-Layer-Does.description" class="shortcut">Description</a></span>
</td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="16" height="16" border="0" alt="Home"></a></td>
<td><a accesskey="u" href="chimara-glk-spec-the-blorb-layer.html"><img src="up.png" width="16" height="16" border="0" alt="Up"></a></td>
<td><a accesskey="p" href="chimara-What-the-Library-Does.html"><img src="left.png" width="16" height="16" border="0" alt="Prev"></a></td>
<td><a accesskey="n" href="chimara-Blorb-Errors.html"><img src="right.png" width="16" height="16" border="0" alt="Next"></a></td>
</tr></table>
<div class="refentry" lang="en">
<a name="chimara-What-the-Blorb-Layer-Does"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="chimara-What-the-Blorb-Layer-Does.top_of_page"></a>What the Blorb Layer Does</span></h2>
<p>What the Blorb Layer Does — The platform-independent functions in the Blorb layer</p>
</td>
<td class="gallery_image" valign="top" align="right"></td>
</tr></table></div>
<div class="refsect1" lang="en">
<a name="chimara-What-the-Blorb-Layer-Does.functions"></a><h2>Functions</h2>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="function_type">
<a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
</td>
<td class="function_name">
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-create-map" title="giblorb_create_map ()">giblorb_create_map</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
</td>
<td class="function_name">
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-destroy-map" title="giblorb_destroy_map ()">giblorb_destroy_map</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
</td>
<td class="function_name">
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-type" title="giblorb_load_chunk_by_type ()">giblorb_load_chunk_by_type</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
</td>
<td class="function_name">
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-number" title="giblorb_load_chunk_by_number ()">giblorb_load_chunk_by_number</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
</td>
<td class="function_name">
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-unload-chunk" title="giblorb_unload_chunk ()">giblorb_unload_chunk</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
</td>
<td class="function_name">
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-resource" title="giblorb_load_resource ()">giblorb_load_resource</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
</td>
<td class="function_name">
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-count-resources" title="giblorb_count_resources ()">giblorb_count_resources</a> <span class="c_punctuation">()</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1" lang="en">
<a name="chimara-What-the-Blorb-Layer-Does.other"></a><h2>Types and Values</h2>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="datatype_keyword"> </td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-result-t" title="giblorb_result_t">giblorb_result_t</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-DontLoad" title="giblorb_method_DontLoad">giblorb_method_DontLoad</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-Memory" title="giblorb_method_Memory">giblorb_method_Memory</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-FilePos" title="giblorb_method_FilePos">giblorb_method_FilePos</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-Exec" title="giblorb_ID_Exec">giblorb_ID_Exec</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-Snd" title="giblorb_ID_Snd">giblorb_ID_Snd</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-Pict" title="giblorb_ID_Pict">giblorb_ID_Pict</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-Data" title="giblorb_ID_Data">giblorb_ID_Data</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-Copyright" title="giblorb_ID_Copyright">giblorb_ID_Copyright</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-AUTH" title="giblorb_ID_AUTH">giblorb_ID_AUTH</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-ANNO" title="giblorb_ID_ANNO">giblorb_ID_ANNO</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-TEXT" title="giblorb_ID_TEXT">giblorb_ID_TEXT</a></td>
</tr>
<tr>
<td class="define_keyword">#define</td>
<td class="function_name"><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-BINA" title="giblorb_ID_BINA">giblorb_ID_BINA</a></td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1" lang="en">
<a name="chimara-What-the-Blorb-Layer-Does.includes"></a><h2>Includes</h2>
<pre class="synopsis">#include &lt;libchimara/glk.h&gt;
#include &lt;libchimara/gi-blorb.h&gt;
</pre>
</div>
<div class="refsect1" lang="en">
<a name="chimara-What-the-Blorb-Layer-Does.description"></a><h2>Description</h2>
<p>These are the functions which are implemented in <code class="literal">gi_blorb.c</code>.
They will be compiled into the library, but they are the same on every
platform.
In general, only the library needs to call these functions.
The Glk program should allow the library to do all the resource handling.</p>
</div>
<div class="refsect1" lang="en">
<a name="chimara-What-the-Blorb-Layer-Does.functions_details"></a><h2>Functions</h2>
<div class="refsect2" lang="en">
<a name="giblorb-create-map"></a><h3>giblorb_create_map ()</h3>
<pre class="programlisting"><a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
giblorb_create_map (<em class="parameter"><code><a href="chimara-Opaque-Objects.html#strid-t" title="strid_t"><span class="type">strid_t</span></a> file</code></em>,
                    <em class="parameter"><code><a href="chimara-What-the-Program-Does.html#giblorb-map-t" title="giblorb_map_t"><span class="type">giblorb_map_t</span></a> **newmap</code></em>);</pre>
<p>Reads Blorb data out of a Glk stream. It does not load every resource at 
once; instead, it creates a map in memory which makes it easy to find 
resources. A pointer to the map is stored in <em class="parameter"><code>newmap</code></em>
. This is an opaque 
object; you pass it to the other Blorb-layer functions.</p>
<div class="refsect3" lang="en">
<a name="giblorb-create-map.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>file</p></td>
<td class="parameter_description"><p>An input stream pointing to a Blorb file.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>newmap</p></td>
<td class="parameter_description"><p>Return location for a Blorb resource map.</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3" lang="en">
<a name="giblorb-create-map.returns"></a><h4>Returns</h4>
<p> a Blorb error code. </p>
</div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-destroy-map"></a><h3>giblorb_destroy_map ()</h3>
<pre class="programlisting"><a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
giblorb_destroy_map (<em class="parameter"><code><a href="chimara-What-the-Program-Does.html#giblorb-map-t" title="giblorb_map_t"><span class="type">giblorb_map_t</span></a> *map</code></em>);</pre>
<p>Deallocates <em class="parameter"><code>map</code></em>
 and all associated memory. This does 
<span class="emphasis"><em>not</em></span> close the original stream.</p>
<div class="refsect3" lang="en">
<a name="giblorb-destroy-map.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody><tr>
<td class="parameter_name"><p>map</p></td>
<td class="parameter_description"><p>A Blorb resource map to deallocate.</p></td>
<td class="parameter_annotations"> </td>
</tr></tbody>
</table></div>
</div>
<div class="refsect3" lang="en">
<a name="giblorb-destroy-map.returns"></a><h4>Returns</h4>
<p> a Blorb error code. </p>
</div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-load-chunk-by-type"></a><h3>giblorb_load_chunk_by_type ()</h3>
<pre class="programlisting"><a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
giblorb_load_chunk_by_type (<em class="parameter"><code><a href="chimara-What-the-Program-Does.html#giblorb-map-t" title="giblorb_map_t"><span class="type">giblorb_map_t</span></a> *map</code></em>,
                            <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> method</code></em>,
                            <em class="parameter"><code><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-result-t" title="giblorb_result_t"><span class="type">giblorb_result_t</span></a> *res</code></em>,
                            <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> chunktype</code></em>,
                            <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> count</code></em>);</pre>
<p>Loads a chunk of a given type. The <em class="parameter"><code>count</code></em>
 parameter distinguishes between 
chunks of the same type. If <em class="parameter"><code>count</code></em>
 is zero, the first chunk of that type is 
loaded, and so on.</p>
<p>To load a chunk of an IFF FORM type (such as AIFF), you should pass in the 
form type, rather than FORM.</p>
<div class="note">
<h3 class="title"></h3>
<p>
 This introduces a slight ambiguity — you cannot distiguish between a 
 FORM AIFF chunk and a non-FORM chunk of type AIFF. However, the latter is 
 almost certainly a mistake.
</p>
</div>
<p>The returned data is written into <em class="parameter"><code>res</code></em>
, according to <em class="parameter"><code>method</code></em>
.</p>
<p>The <em class="structfield"><code>chunknum</code></em> field is filled in with the number of
the chunk. (This value can then be passed to <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-number" title="giblorb_load_chunk_by_number ()"><code class="function">giblorb_load_chunk_by_number()</code></a> 
or <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-unload-chunk" title="giblorb_unload_chunk ()"><code class="function">giblorb_unload_chunk()</code></a>.) The <em class="structfield"><code>length</code></em> field is 
filled in with the length of the chunk in bytes. The 
<em class="structfield"><code>chunktype</code></em> field is the chunk's type, which of 
course will be the type you asked for.</p>
<p>If you specify <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-DontLoad" title="giblorb_method_DontLoad"><code class="literal">giblorb_method_DontLoad</code></a>, no data is actually loaded in. You
can use this if you are only interested in whether a chunk exists, or in the
<em class="structfield"><code>chunknum</code></em> and <em class="structfield"><code>length</code></em> 
parameters.</p>
<p>If you specify <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-FilePos" title="giblorb_method_FilePos"><code class="literal">giblorb_method_FilePos</code></a>, 
<em class="structfield"><code>data.startpos</code></em> is filled in with the file position
of the chunk data. You can use <a href="chimara-Stream-Positions.html#glk-stream-set-position" title="glk_stream_set_position ()"><code class="function">glk_stream_set_position()</code></a> to read the data 
from the stream.</p>
<p>If you specify <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-Memory" title="giblorb_method_Memory"><code class="literal">giblorb_method_Memory</code></a>, <em class="structfield"><code>data.ptr</code></em> is
filled with a pointer to allocated memory containing the chunk data. This 
memory is owned by the map, not you. If you load the chunk more than once 
with <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-Memory" title="giblorb_method_Memory"><code class="literal">giblorb_method_Memory</code></a>, the Blorb layer is smart enough to keep just one
copy in memory. You should not deallocate this memory yourself; call 
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-unload-chunk" title="giblorb_unload_chunk ()"><code class="function">giblorb_unload_chunk()</code></a> instead.</p>
<div class="refsect3" lang="en">
<a name="giblorb-load-chunk-by-type.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>map</p></td>
<td class="parameter_description"><p>The Blorb resource map to load a chunk from.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>method</p></td>
<td class="parameter_description"><p>The loading method to use, one of <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-DontLoad" title="giblorb_method_DontLoad"><code class="literal">giblorb_method_DontLoad</code></a>,
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-Memory" title="giblorb_method_Memory"><code class="literal">giblorb_method_Memory</code></a>, or <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-FilePos" title="giblorb_method_FilePos"><code class="literal">giblorb_method_FilePos</code></a>.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>res</p></td>
<td class="parameter_description"><p>Return location for the result.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>chunktype</p></td>
<td class="parameter_description"><p>The type of chunk to load.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>count</p></td>
<td class="parameter_description"><p>The chunk number of type <em class="parameter"><code>chunktype</code></em>
to load.</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3" lang="en">
<a name="giblorb-load-chunk-by-type.returns"></a><h4>Returns</h4>
<p> a Blorb error code.</p>
</div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-load-chunk-by-number"></a><h3>giblorb_load_chunk_by_number ()</h3>
<pre class="programlisting"><a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
giblorb_load_chunk_by_number (<em class="parameter"><code><a href="chimara-What-the-Program-Does.html#giblorb-map-t" title="giblorb_map_t"><span class="type">giblorb_map_t</span></a> *map</code></em>,
                              <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> method</code></em>,
                              <em class="parameter"><code><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-result-t" title="giblorb_result_t"><span class="type">giblorb_result_t</span></a> *res</code></em>,
                              <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> chunknum</code></em>);</pre>
<p>This is similar to <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-type" title="giblorb_load_chunk_by_type ()"><code class="function">giblorb_load_chunk_by_type()</code></a>, but it loads a chunk with a
given chunk number. The type of the chunk can be found in the 
<em class="structfield"><code>chunktype</code></em> field of <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-result-t" title="giblorb_result_t"><span class="type">giblorb_result_t</span></a>. You can get
the chunk number from the <em class="structfield"><code>chunknum</code></em> field, after 
calling one of the other load functions.</p>
<div class="refsect3" lang="en">
<a name="giblorb-load-chunk-by-number.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>map</p></td>
<td class="parameter_description"><p>The Blorb resource map to load a chunk from.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>method</p></td>
<td class="parameter_description"><p>The loading method to use, one of <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-DontLoad" title="giblorb_method_DontLoad"><code class="literal">giblorb_method_DontLoad</code></a>,
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-Memory" title="giblorb_method_Memory"><code class="literal">giblorb_method_Memory</code></a>, or <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-FilePos" title="giblorb_method_FilePos"><code class="literal">giblorb_method_FilePos</code></a>.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>res</p></td>
<td class="parameter_description"><p>Return location for the result.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>chunknum</p></td>
<td class="parameter_description"><p>The chunk number to load.</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3" lang="en">
<a name="giblorb-load-chunk-by-number.returns"></a><h4>Returns</h4>
<p> a Blorb error code. </p>
</div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-unload-chunk"></a><h3>giblorb_unload_chunk ()</h3>
<pre class="programlisting"><a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
giblorb_unload_chunk (<em class="parameter"><code><a href="chimara-What-the-Program-Does.html#giblorb-map-t" title="giblorb_map_t"><span class="type">giblorb_map_t</span></a> *map</code></em>,
                      <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> chunknum</code></em>);</pre>
<p>Frees the chunk data allocated by <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-Memory" title="giblorb_method_Memory"><code class="literal">giblorb_method_Memory</code></a>. If the given chunk
has never been loaded into memory, this has no effect.</p>
<div class="refsect3" lang="en">
<a name="giblorb-unload-chunk.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>map</p></td>
<td class="parameter_description"><p>The Blorb resource map to unload a chunk from.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>chunknum</p></td>
<td class="parameter_description"><p>The chunk number to unload.</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3" lang="en">
<a name="giblorb-unload-chunk.returns"></a><h4>Returns</h4>
<p> a Blorb error code.</p>
</div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-load-resource"></a><h3>giblorb_load_resource ()</h3>
<pre class="programlisting"><a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
giblorb_load_resource (<em class="parameter"><code><a href="chimara-What-the-Program-Does.html#giblorb-map-t" title="giblorb_map_t"><span class="type">giblorb_map_t</span></a> *map</code></em>,
                       <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> method</code></em>,
                       <em class="parameter"><code><a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-result-t" title="giblorb_result_t"><span class="type">giblorb_result_t</span></a> *res</code></em>,
                       <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> usage</code></em>,
                       <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> resnum</code></em>);</pre>
<p>Loads a resource, given its usage and resource number. Currently, the three
usage values are <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-Pict" title="giblorb_ID_Pict"><code class="literal">giblorb_ID_Pict</code></a> (images), <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-Snd" title="giblorb_ID_Snd"><code class="literal">giblorb_ID_Snd</code></a> (sounds), and
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-ID-Exec" title="giblorb_ID_Exec"><code class="literal">giblorb_ID_Exec</code></a> (executable program). See the Blorb specification for more
information about the types of data that can be stored for these usages.</p>
<p>Note that a resource number is not the same as a chunk number. The resource
number is the sound or image number specified by a Glk program. Chunk number
is arbitrary, since chunks in a Blorb file can be in any order. To find the
chunk number of a given resource, call <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-resource" title="giblorb_load_resource ()"><code class="function">giblorb_load_resource()</code></a> and look in
<em class="structfield"><code>res.chunknum</code></em>.</p>
<div class="refsect3" lang="en">
<a name="giblorb-load-resource.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>map</p></td>
<td class="parameter_description"><p>The Blorb resource map to load a resource from.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>method</p></td>
<td class="parameter_description"><p>The loading method to use, one of <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-DontLoad" title="giblorb_method_DontLoad"><code class="literal">giblorb_method_DontLoad</code></a>,
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-Memory" title="giblorb_method_Memory"><code class="literal">giblorb_method_Memory</code></a>, or <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-FilePos" title="giblorb_method_FilePos"><code class="literal">giblorb_method_FilePos</code></a>.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>res</p></td>
<td class="parameter_description"><p>Return location for the result.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>usage</p></td>
<td class="parameter_description"><p>The type of data resource to load.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>resnum</p></td>
<td class="parameter_description"><p>The resource number to load.</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3" lang="en">
<a name="giblorb-load-resource.returns"></a><h4>Returns</h4>
<p> a Blorb error code.</p>
</div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-count-resources"></a><h3>giblorb_count_resources ()</h3>
<pre class="programlisting"><a href="chimara-Blorb-Errors.html#giblorb-err-t" title="giblorb_err_t"><span class="returnvalue">giblorb_err_t</span></a>
giblorb_count_resources (<em class="parameter"><code><a href="chimara-What-the-Program-Does.html#giblorb-map-t" title="giblorb_map_t"><span class="type">giblorb_map_t</span></a> *map</code></em>,
                         <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> usage</code></em>,
                         <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> *num</code></em>,
                         <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> *min</code></em>,
                         <em class="parameter"><code><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> *max</code></em>);</pre>
<p>Counts the number of chunks with a given usage (image, sound, or executable.)
The total number of chunks of that usage is stored in <em class="parameter"><code>num</code></em>
. The lowest and 
highest resource number of that usage are stored in <em class="parameter"><code>min</code></em>
 and <em class="parameter"><code>max</code></em>
. You can
leave any of the three pointers <code class="literal">NULL</code> if you don't care about that
information.</p>
<div class="refsect3" lang="en">
<a name="giblorb-count-resources.parameters"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>map</p></td>
<td class="parameter_description"><p>The Blorb resource map in which to count the resources.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>usage</p></td>
<td class="parameter_description"><p>The type of data resource to count.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>num</p></td>
<td class="parameter_description"><p>Return location for the number of chunks of <em class="parameter"><code>usage</code></em>
.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>min</p></td>
<td class="parameter_description"><p>Return location for the lowest resource number of <em class="parameter"><code>usage</code></em>
.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>max</p></td>
<td class="parameter_description"><p>Return location for the highest resource number of <em class="parameter"><code>usage</code></em>
.</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3" lang="en">
<a name="giblorb-count-resources.returns"></a><h4>Returns</h4>
<p> a Blorb error code.</p>
</div>
</div>
</div>
<div class="refsect1" lang="en">
<a name="chimara-What-the-Blorb-Layer-Does.other_details"></a><h2>Types and Values</h2>
<div class="refsect2" lang="en">
<a name="giblorb-result-t"></a><h3>giblorb_result_t</h3>
<pre class="programlisting">typedef struct {
    glui32 chunknum; /* The chunk number (for use in 
        giblorb_unload_chunk(), etc.) */
    union {
        void *ptr; /* A pointer to the data (if you used 
            giblorb_method_Memory) */
        glui32 startpos; /* The position in the file (if you 
            used giblorb_method_FilePos) */
    } data;
    glui32 length; /* The length of the data */
    glui32 chunktype; /* The type of the chunk. */
} giblorb_result_t;
</pre>
<p>Holds information about a chunk loaded from a Blorb file, and the method of
accessing the chunk data. <em class="parameter"><code>data</code></em>
 is a union of <em class="parameter"><code>ptr</code></em>
, a pointer to the data (if
you used <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-Memory" title="giblorb_method_Memory"><code class="literal">giblorb_method_Memory</code></a>) and <em class="parameter"><code>startpos</code></em>
, the position in the file (if
you used <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-method-FilePos" title="giblorb_method_FilePos"><code class="literal">giblorb_method_FilePos</code></a>). See <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-type" title="giblorb_load_chunk_by_type ()"><code class="function">giblorb_load_chunk_by_type()</code></a> and
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-number" title="giblorb_load_chunk_by_number ()"><code class="function">giblorb_load_chunk_by_number()</code></a>.</p>
<div class="refsect3" lang="en">
<a name="giblorb-result-t.members"></a><h4>Members</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="struct_member_name"><p><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> <em class="structfield"><code><a name="giblorb-result-t.chunknum"></a>chunknum</code></em>;</p></td>
<td class="struct_member_description"><p>The chunk number (for use in <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-unload-chunk" title="giblorb_unload_chunk ()"><code class="function">giblorb_unload_chunk()</code></a>, etc.)</p></td>
<td class="struct_member_annotations"> </td>
</tr>
<tr>
<td class="struct_member_name"><p><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> <em class="structfield"><code><a name="giblorb-result-t.length"></a>length</code></em>;</p></td>
<td class="struct_member_description"><p>The length of the data</p></td>
<td class="struct_member_annotations"> </td>
</tr>
<tr>
<td class="struct_member_name"><p><a href="chimara-Basic-Types.html#glui32" title="glui32"><span class="type">glui32</span></a> <em class="structfield"><code><a name="giblorb-result-t.chunktype"></a>chunktype</code></em>;</p></td>
<td class="struct_member_description"><p>The type of the chunk.</p></td>
<td class="struct_member_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-method-DontLoad"></a><h3>giblorb_method_DontLoad</h3>
<pre class="programlisting">#define giblorb_method_DontLoad (0)
</pre>
<p>Pass this to <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-type" title="giblorb_load_chunk_by_type ()"><code class="function">giblorb_load_chunk_by_type()</code></a>, <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-number" title="giblorb_load_chunk_by_number ()"><code class="function">giblorb_load_chunk_by_number()</code></a>, or
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-resource" title="giblorb_load_resource ()"><code class="function">giblorb_load_resource()</code></a> to obtain information about a chunk without actually
loading it.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-method-Memory"></a><h3>giblorb_method_Memory</h3>
<pre class="programlisting">#define giblorb_method_Memory (1)
</pre>
<p>Pass this to <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-type" title="giblorb_load_chunk_by_type ()"><code class="function">giblorb_load_chunk_by_type()</code></a>, <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-number" title="giblorb_load_chunk_by_number ()"><code class="function">giblorb_load_chunk_by_number()</code></a>, or
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-resource" title="giblorb_load_resource ()"><code class="function">giblorb_load_resource()</code></a> to load a chunk into memory.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-method-FilePos"></a><h3>giblorb_method_FilePos</h3>
<pre class="programlisting">#define giblorb_method_FilePos (2)
</pre>
<p>Pass this to <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-type" title="giblorb_load_chunk_by_type ()"><code class="function">giblorb_load_chunk_by_type()</code></a>, <a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-chunk-by-number" title="giblorb_load_chunk_by_number ()"><code class="function">giblorb_load_chunk_by_number()</code></a>, or
<a href="chimara-What-the-Blorb-Layer-Does.html#giblorb-load-resource" title="giblorb_load_resource ()"><code class="function">giblorb_load_resource()</code></a> to get the position in the Blorb file at which the
chunk data starts.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-Exec"></a><h3>giblorb_ID_Exec</h3>
<pre class="programlisting">#define giblorb_ID_Exec      (giblorb_make_id('E', 'x', 'e', 'c'))
</pre>
<p>Resource usage constant representing an executable program.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-Snd"></a><h3>giblorb_ID_Snd</h3>
<pre class="programlisting">#define giblorb_ID_Snd       (giblorb_make_id('S', 'n', 'd', ' '))
</pre>
<p>Resource usage constant representing a sound file.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-Pict"></a><h3>giblorb_ID_Pict</h3>
<pre class="programlisting">#define giblorb_ID_Pict      (giblorb_make_id('P', 'i', 'c', 't'))
</pre>
<p>Resource usage constant representing an image file.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-Data"></a><h3>giblorb_ID_Data</h3>
<pre class="programlisting">#define giblorb_ID_Data      (giblorb_make_id('D', 'a', 't', 'a'))
</pre>
<p>Resource usage constant representing a data file.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-Copyright"></a><h3>giblorb_ID_Copyright</h3>
<pre class="programlisting">#define giblorb_ID_Copyright (giblorb_make_id('(', 'c', ')', ' '))
</pre>
<p>Resource usage constant representing the copyright message (date and holder, 
without the actual copyright symbol). There should only be one such chunk per
file.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-AUTH"></a><h3>giblorb_ID_AUTH</h3>
<pre class="programlisting">#define giblorb_ID_AUTH      (giblorb_make_id('A', 'U', 'T', 'H'))
</pre>
<p>Resource usage constant representing the name of the author or creator of the
file. This could be a login name on multi-user systems, for example. There
should only be one such chunk per file.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-ANNO"></a><h3>giblorb_ID_ANNO</h3>
<pre class="programlisting">#define giblorb_ID_ANNO      (giblorb_make_id('A', 'N', 'N', 'O'))
</pre>
<p>Resource usage constant representing any textual annotation that the user or 
writing program sees fit to include.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-TEXT"></a><h3>giblorb_ID_TEXT</h3>
<pre class="programlisting">#define giblorb_ID_TEXT      (giblorb_make_id('T', 'E', 'X', 'T'))
</pre>
<p>Resource usage constant representing a text data file.</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="giblorb-ID-BINA"></a><h3>giblorb_ID_BINA</h3>
<pre class="programlisting">#define giblorb_ID_BINA      (giblorb_make_id('B', 'I', 'N', 'A'))
</pre>
<p>Resource usage constant representing a binary data file.</p>
</div>
</div>
</div>
<div class="footer">
<hr>Generated by GTK-Doc V1.25</div>
</body>
</html>